{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/callBackend.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { cookies } from \"next/headers\"\r\n\r\nexport interface BackendError {\r\n  status: number\r\n  code?: string\r\n  message: string\r\n  details?: unknown\r\n}\r\n\r\n// ===========================================\r\n// üß† handleApiAction ‚Äî ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Next API routes\r\n// ===========================================\r\nexport async function handleApiAction(\r\n  req: NextRequest,\r\n  actionMap: Record<string, (body: unknown) => Promise<NextResponse>>\r\n): Promise<NextResponse> {\r\n  try {\r\n    let action: string | null = null\r\n    let body: unknown = {}\r\n\r\n    // ‚úÖ ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° method\r\n    if (req.method === \"GET\") {\r\n      const { searchParams } = new URL(req.url)\r\n      action = searchParams.get(\"action\")\r\n      const obj: Record<string, string> = {}\r\n      searchParams.forEach((v, k) => (obj[k] = v))\r\n      body = obj\r\n    } else {\r\n      // POST, PUT, PATCH, DELETE\r\n      body = await req.json()\r\n      action = (body as Record<string, unknown>).action as string\r\n    }\r\n\r\n    if (!action) {\r\n      return NextResponse.json({ error: true, message: \"Missing action\" }, { status: 400 })\r\n    }\r\n\r\n    const handler = actionMap[action]\r\n    if (!handler) {\r\n      return NextResponse.json({ error: true, message: `Unknown action: ${action}` }, { status: 400 })\r\n    }\r\n\r\n    return await handler(body)\r\n  } catch (err) {\r\n    const e = err as Partial<BackendError>\r\n    const status = typeof e.status === \"number\" && e.status > 0 ? e.status : 500\r\n    const message = e.message || \"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ)\"\r\n    console.error(`‚ùå handleApiAction error [${status}]:`, message)\r\n    return NextResponse.json(\r\n      { error: true, code: e.code ?? \"INTERNAL_ERROR\", message },\r\n      { status }\r\n    )\r\n  }\r\n}\r\n\r\n// ===========================================\r\n// üîß callBackend ‚Äî ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á Express backend\r\n// ===========================================\r\nexport async function callBackend<T>(\r\n  endpoint: string,\r\n  body?: unknown,\r\n  method: \"POST\" | \"GET\" = \"POST\"\r\n): Promise<T> {\r\n  const baseUrl = process.env.API_URL || \"http://localhost:4000\"\r\n  const url = `${baseUrl}${endpoint}`\r\n\r\n  const cookieStore = await cookies()\r\n  const cookieHeader = cookieStore.toString()\r\n  const options: RequestInit = {\r\n    method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Cookie: cookieHeader,\r\n    },\r\n    body: method === \"POST\" && body ? JSON.stringify(body) : undefined,\r\n    credentials: \"include\",\r\n  }\r\n\r\n  let res: Response\r\n  try {\r\n    res = await fetch(url, options)\r\n  } catch (networkError) {\r\n    throw {\r\n      status: 0,\r\n      code: \"NETWORK_ERROR\",\r\n      message: \"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ\",\r\n      details: networkError,\r\n    } satisfies BackendError\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text()\r\n    try {\r\n      const parsed = JSON.parse(text)\r\n      throw {\r\n        status: res.status,\r\n        code: parsed.code ?? `HTTP_${res.status}`,\r\n        message: parsed.message ?? `Backend error ${res.status}`,\r\n        details: parsed.details,\r\n      } satisfies BackendError\r\n    } catch {\r\n      throw {\r\n        status: res.status,\r\n        code: `HTTP_${res.status}`,\r\n        message: text || `Backend error ${res.status}`,\r\n      } satisfies BackendError\r\n    }\r\n  }\r\n\r\n  return (await res.json()) as T\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAYO,eAAe,gBACpB,GAAgB,EAChB,SAAmE;IAEnE,IAAI;QACF,IAAI,SAAwB;QAC5B,IAAI,OAAgB,CAAC;QAErB,kBAAkB;QAClB,IAAI,IAAI,MAAM,KAAK,OAAO;YACxB,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;YACxC,SAAS,aAAa,GAAG,CAAC;YAC1B,MAAM,MAA8B,CAAC;YACrC,aAAa,OAAO,CAAC,CAAC,GAAG,IAAO,GAAG,CAAC,EAAE,GAAG;YACzC,OAAO;QACT,OAAO;YACL,2BAA2B;YAC3B,OAAO,MAAM,IAAI,IAAI;YACrB,SAAS,AAAC,KAAiC,MAAM;QACnD;QAEA,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAM,SAAS;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACrF;QAEA,MAAM,UAAU,SAAS,CAAC,OAAO;QACjC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAM,SAAS,CAAC,gBAAgB,EAAE,QAAQ;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAChG;QAEA,OAAO,MAAM,QAAQ;IACvB,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI;QACV,MAAM,SAAS,OAAO,EAAE,MAAM,KAAK,YAAY,EAAE,MAAM,GAAG,IAAI,EAAE,MAAM,GAAG;QACzE,MAAM,UAAU,EAAE,OAAO,IAAI;QAC7B,QAAQ,KAAK,CAAC,CAAC,yBAAyB,EAAE,OAAO,EAAE,CAAC,EAAE;QACtD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAM,MAAM,EAAE,IAAI,IAAI;YAAkB;QAAQ,GACzD;YAAE;QAAO;IAEb;AACF;AAKO,eAAe,YACpB,QAAgB,EAChB,IAAc,EACd,SAAyB,MAAM;IAE/B,MAAM,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACvC,MAAM,MAAM,GAAG,UAAU,UAAU;IAEnC,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,eAAe,YAAY,QAAQ;IACzC,MAAM,UAAuB;QAC3B;QACA,SAAS;YACP,gBAAgB;YAChB,QAAQ;QACV;QACA,MAAM,WAAW,UAAU,OAAO,KAAK,SAAS,CAAC,QAAQ;QACzD,aAAa;IACf;IAEA,IAAI;IACJ,IAAI;QACF,MAAM,MAAM,MAAM,KAAK;IACzB,EAAE,OAAO,cAAc;QACrB,MAAM;YACJ,QAAQ;YACR,MAAM;YACN,SAAS;YACT,SAAS;QACX;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI;YACF,MAAM,SAAS,KAAK,KAAK,CAAC;YAC1B,MAAM;gBACJ,QAAQ,IAAI,MAAM;gBAClB,MAAM,OAAO,IAAI,IAAI,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;gBACzC,SAAS,OAAO,OAAO,IAAI,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;gBACxD,SAAS,OAAO,OAAO;YACzB;QACF,EAAE,OAAM;YACN,MAAM;gBACJ,QAAQ,IAAI,MAAM;gBAClB,MAAM,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;gBAC1B,SAAS,QAAQ,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;YAChD;QACF;IACF;IAEA,OAAQ,MAAM,IAAI,IAAI;AACxB","debugId":null}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/api/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { callBackend } from \"@/lib/callBackend\"\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json()\n    const result = await callBackend(\"/api/login\", body, \"POST\")\n    \n    // üü¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á response object\n    const res = NextResponse.json(result)\n\n    // üü¢ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ token ‡∏à‡∏≤‡∏Å Express ‚Üí set cookie ‡πÉ‡∏ô domain ‡∏Ç‡∏≠‡∏á Next.js\n    const token = (result as any)?.token\n    if (token) {\n      res.cookies.set(\"authToken\", token, {\n        httpOnly: true,\n        secure: process.env.NODE_ENV === \"production\",\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 60 * 60 * 24 * 7, // 7 ‡∏ß‡∏±‡∏ô\n      })\n      console.log(\"üç™ Cookie set: authToken\")\n    } else {\n      console.warn(\"‚ö†Ô∏è No token found in response from backend.\")\n    }\n\n    return res\n  } catch (err) {\n    console.error(\"‚ùå Login error:\", err)\n    return NextResponse.json(\n      { success: false, message: \"Login failed\", details: err },\n      { status: 500 }\n    )\n  }\n}\n\n// ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö GET /api/login\nexport async function GET() {\n  return NextResponse.json({\n    success: true,\n    message: \"Next.js ‚Üí Express login proxy active ‚úÖ\",\n  })\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,cAAc,MAAM;QAErD,2BAA2B;QAC3B,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;QAE9B,gEAAgE;QAChE,MAAM,QAAS,QAAgB;QAC/B,IAAI,OAAO;YACT,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,OAAO;gBAClC,UAAU;gBACV,QAAQ,oDAAyB;gBACjC,UAAU;gBACV,MAAM;gBACN,QAAQ,KAAK,KAAK,KAAK;YACzB;YACA,QAAQ,GAAG,CAAC;QACd,OAAO;YACL,QAAQ,IAAI,CAAC;QACf;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,SAAS;YAAgB,SAAS;QAAI,GACxD;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe;IACpB,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,SAAS;QACT,SAAS;IACX;AACF","debugId":null}}]
}
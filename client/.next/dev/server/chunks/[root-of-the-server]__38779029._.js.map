{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/callBackend.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { cookies } from \"next/headers\"\r\n\r\nexport interface BackendError {\r\n  status: number\r\n  code?: string\r\n  message: string\r\n  details?: unknown\r\n}\r\n\r\n// ===========================================\r\n// üß† handleApiAction ‚Äî ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Next API routes\r\n// ===========================================\r\nexport async function handleApiAction(\r\n  req: NextRequest,\r\n  actionMap: Record<string, (body: unknown) => Promise<NextResponse>>\r\n): Promise<NextResponse> {\r\n  try {\r\n    let action: string | null = null\r\n    let body: unknown = {}\r\n\r\n    // ‚úÖ ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° method\r\n    if (req.method === \"GET\") {\r\n      const { searchParams } = new URL(req.url)\r\n      action = searchParams.get(\"action\")\r\n      const obj: Record<string, string> = {}\r\n      searchParams.forEach((v, k) => (obj[k] = v))\r\n      body = obj\r\n    } else {\r\n      // POST, PUT, PATCH, DELETE\r\n      body = await req.json()\r\n      action = (body as Record<string, unknown>).action as string\r\n    }\r\n\r\n    if (!action) {\r\n      return NextResponse.json({ error: true, message: \"Missing action\" }, { status: 400 })\r\n    }\r\n\r\n    const handler = actionMap[action]\r\n    if (!handler) {\r\n      return NextResponse.json({ error: true, message: `Unknown action: ${action}` }, { status: 400 })\r\n    }\r\n\r\n    return await handler(body)\r\n  } catch (err) {\r\n    const e = err as Partial<BackendError>\r\n    const status = typeof e.status === \"number\" && e.status > 0 ? e.status : 500\r\n    const message = e.message || \"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ)\"\r\n    console.error(`‚ùå handleApiAction error [${status}]:`, message)\r\n    return NextResponse.json(\r\n      { error: true, code: e.code ?? \"INTERNAL_ERROR\", message },\r\n      { status }\r\n    )\r\n  }\r\n}\r\n\r\n// ===========================================\r\n// üîß callBackend ‚Äî ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á Express backend\r\n// ===========================================\r\nexport async function callBackend<T>(\r\n  endpoint: string,\r\n  body?: unknown,\r\n  method: \"POST\" | \"GET\" = \"POST\"\r\n): Promise<T> {\r\n  const baseUrl = process.env.API_URL || \"http://localhost:4000\"\r\n  const url = `${baseUrl}${endpoint}`\r\n\r\n  const cookieStore = await cookies()\r\n  const cookieHeader = cookieStore.toString()\r\n  const options: RequestInit = {\r\n    method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Cookie: cookieHeader,\r\n    },\r\n    body: method === \"POST\" && body ? JSON.stringify(body) : undefined,\r\n    credentials: \"include\",\r\n  }\r\n\r\n  let res: Response\r\n  try {\r\n    res = await fetch(url, options)\r\n  } catch (networkError) {\r\n    throw {\r\n      status: 0,\r\n      code: \"NETWORK_ERROR\",\r\n      message: \"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ\",\r\n      details: networkError,\r\n    } satisfies BackendError\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text()\r\n    try {\r\n      const parsed = JSON.parse(text)\r\n      throw {\r\n        status: res.status,\r\n        code: parsed.code ?? `HTTP_${res.status}`,\r\n        message: parsed.message ?? `Backend error ${res.status}`,\r\n        details: parsed.details,\r\n      } satisfies BackendError\r\n    } catch {\r\n      throw {\r\n        status: res.status,\r\n        code: `HTTP_${res.status}`,\r\n        message: text || `Backend error ${res.status}`,\r\n      } satisfies BackendError\r\n    }\r\n  }\r\n\r\n  return (await res.json()) as T\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAYO,eAAe,gBACpB,GAAgB,EAChB,SAAmE;IAEnE,IAAI;QACF,IAAI,SAAwB;QAC5B,IAAI,OAAgB,CAAC;QAErB,kBAAkB;QAClB,IAAI,IAAI,MAAM,KAAK,OAAO;YACxB,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;YACxC,SAAS,aAAa,GAAG,CAAC;YAC1B,MAAM,MAA8B,CAAC;YACrC,aAAa,OAAO,CAAC,CAAC,GAAG,IAAO,GAAG,CAAC,EAAE,GAAG;YACzC,OAAO;QACT,OAAO;YACL,2BAA2B;YAC3B,OAAO,MAAM,IAAI,IAAI;YACrB,SAAS,AAAC,KAAiC,MAAM;QACnD;QAEA,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAM,SAAS;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACrF;QAEA,MAAM,UAAU,SAAS,CAAC,OAAO;QACjC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAM,SAAS,CAAC,gBAAgB,EAAE,QAAQ;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAChG;QAEA,OAAO,MAAM,QAAQ;IACvB,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI;QACV,MAAM,SAAS,OAAO,EAAE,MAAM,KAAK,YAAY,EAAE,MAAM,GAAG,IAAI,EAAE,MAAM,GAAG;QACzE,MAAM,UAAU,EAAE,OAAO,IAAI;QAC7B,QAAQ,KAAK,CAAC,CAAC,yBAAyB,EAAE,OAAO,EAAE,CAAC,EAAE;QACtD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAM,MAAM,EAAE,IAAI,IAAI;YAAkB;QAAQ,GACzD;YAAE;QAAO;IAEb;AACF;AAKO,eAAe,YACpB,QAAgB,EAChB,IAAc,EACd,SAAyB,MAAM;IAE/B,MAAM,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACvC,MAAM,MAAM,GAAG,UAAU,UAAU;IAEnC,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,eAAe,YAAY,QAAQ;IACzC,MAAM,UAAuB;QAC3B;QACA,SAAS;YACP,gBAAgB;YAChB,QAAQ;QACV;QACA,MAAM,WAAW,UAAU,OAAO,KAAK,SAAS,CAAC,QAAQ;QACzD,aAAa;IACf;IAEA,IAAI;IACJ,IAAI;QACF,MAAM,MAAM,MAAM,KAAK;IACzB,EAAE,OAAO,cAAc;QACrB,MAAM;YACJ,QAAQ;YACR,MAAM;YACN,SAAS;YACT,SAAS;QACX;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI;YACF,MAAM,SAAS,KAAK,KAAK,CAAC;YAC1B,MAAM;gBACJ,QAAQ,IAAI,MAAM;gBAClB,MAAM,OAAO,IAAI,IAAI,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;gBACzC,SAAS,OAAO,OAAO,IAAI,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;gBACxD,SAAS,OAAO,OAAO;YACzB;QACF,EAAE,OAAM;YACN,MAAM;gBACJ,QAAQ,IAAI,MAAM;gBAClB,MAAM,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;gBAC1B,SAAS,QAAQ,CAAC,cAAc,EAAE,IAAI,MAAM,EAAE;YAChD;QACF;IACF;IAEA,OAAQ,MAAM,IAAI,IAAI;AACxB","debugId":null}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/api/enroll/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { callBackend, handleApiAction } from \"@/lib/callBackend\"\r\n\r\n// ============================================\r\n// üß© Action map ‚Äî ‡∏£‡∏ß‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\r\n// ============================================\r\n\r\nasync function FetchConfig(body: unknown) {\r\n  const query = body as Record<string, string>\r\n  const qs = new URLSearchParams(query).toString()\r\n  const result = await callBackend(`/api/enroll/config/fetch?${qs}`, body, \"GET\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\nasync function FetchManageSubjects(body: unknown) {\r\n  const query = body as Record<string, string>\r\n  const qs = new URLSearchParams(query).toString()\r\n  const result = await callBackend(`/api/enroll/manage/subjects/fetch?${qs}`, body, \"GET\")\r\n  return NextResponse.json(result)\r\n}\r\nasync function FetchManageSections(body: unknown) {\r\n  const query = body as Record<string, string>\r\n  const qs = new URLSearchParams(query).toString()\r\n  const result = await callBackend(`/api/enroll/manage/section/fetch?${qs}`, body, \"GET\")\r\n  return NextResponse.json(result)\r\n}\r\nasync function FetchManageSectionsTeachers(body: unknown) {\r\n  const query = body as Record<string, string>\r\n  const qs = new URLSearchParams(query).toString()\r\n  const result = await callBackend(`/api/enroll/manage/sectionTeacher/fetch?${qs}`, body, \"GET\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\n\r\n\r\nasync function AssignConfig(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/assign\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\nasync function CancelConfig(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/cancel\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\nasync function EditConfig(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/edit\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\nasync function AssignConfigMaxAddCr2(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/assign/maxaAddCr2\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\nasync function EditConfigMaxAddCr2(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/edit/maxaAddCr2\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\nasync function CancelConfigMaxAddCr2(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/cancel/maxaAddCr2\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\nasync function ToggleOpenEnroll(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/config/open/enroll\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\nasync function ToggleOpenSubject(body: unknown) {\r\n  const result = await callBackend(\"/api/enroll/manage/open/subject\", body, \"POST\")\r\n  return NextResponse.json(result)\r\n}\r\n\r\n\r\n// üöÄ Route ‡∏´‡∏•‡∏±‡∏Å\r\nexport async function GET(req: NextRequest) {\r\n  return handleApiAction(req, {\r\n    FetchConfig,\r\n    FetchManageSubjects,\r\n    FetchManageSections,\r\n    FetchManageSectionsTeachers\r\n  })\r\n}\r\n\r\nexport async function POST(req: NextRequest) {\r\n  return handleApiAction(req, {\r\n    AssignConfig,\r\n    CancelConfig,\r\n    EditConfig,\r\n    AssignConfigMaxAddCr2,\r\n    EditConfigMaxAddCr2,\r\n    CancelConfigMaxAddCr2,\r\n    ToggleOpenEnroll,\r\n    ToggleOpenSubject\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,+CAA+C;AAC/C,qCAAqC;AACrC,+CAA+C;AAE/C,eAAe,YAAY,IAAa;IACtC,MAAM,QAAQ;IACd,MAAM,KAAK,IAAI,gBAAgB,OAAO,QAAQ;IAC9C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,CAAC,yBAAyB,EAAE,IAAI,EAAE,MAAM;IACzE,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAEA,eAAe,oBAAoB,IAAa;IAC9C,MAAM,QAAQ;IACd,MAAM,KAAK,IAAI,gBAAgB,OAAO,QAAQ;IAC9C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,CAAC,kCAAkC,EAAE,IAAI,EAAE,MAAM;IAClF,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AACA,eAAe,oBAAoB,IAAa;IAC9C,MAAM,QAAQ;IACd,MAAM,KAAK,IAAI,gBAAgB,OAAO,QAAQ;IAC9C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,CAAC,iCAAiC,EAAE,IAAI,EAAE,MAAM;IACjF,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AACA,eAAe,4BAA4B,IAAa;IACtD,MAAM,QAAQ;IACd,MAAM,KAAK,IAAI,gBAAgB,OAAO,QAAQ;IAC9C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,CAAC,wCAAwC,EAAE,IAAI,EAAE,MAAM;IACxF,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAIA,eAAe,aAAa,IAAa;IACvC,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,6BAA6B,MAAM;IACpE,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAEA,eAAe,aAAa,IAAa;IACvC,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,6BAA6B,MAAM;IACpE,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AACA,eAAe,WAAW,IAAa;IACrC,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,2BAA2B,MAAM;IAClE,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAEA,eAAe,sBAAsB,IAAa;IAChD,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,wCAAwC,MAAM;IAC/E,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AACA,eAAe,oBAAoB,IAAa;IAC9C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,sCAAsC,MAAM;IAC7E,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AACA,eAAe,sBAAsB,IAAa;IAChD,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,wCAAwC,MAAM;IAC/E,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAEA,eAAe,iBAAiB,IAAa;IAC3C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,kCAAkC,MAAM;IACzE,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAEA,eAAe,kBAAkB,IAAa;IAC5C,MAAM,SAAS,MAAM,IAAA,0IAAW,EAAC,mCAAmC,MAAM;IAC1E,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAIO,eAAe,IAAI,GAAgB;IACxC,OAAO,IAAA,8IAAe,EAAC,KAAK;QAC1B;QACA;QACA;QACA;IACF;AACF;AAEO,eAAe,KAAK,GAAgB;IACzC,OAAO,IAAA,8IAAe,EAAC,KAAK;QAC1B;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACF;AACF","debugId":null}}]
}